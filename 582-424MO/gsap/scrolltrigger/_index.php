<?php 
/**
 * @type     article
 * @title    6-ScrollTrigger
 * @icon     ../images/icon.webp
 * @abstract Synchroniser une animation le scroll : intro, markers, start, end, toggleActions
 * @index    800
 * @ref      web/cadriciels/gsap
 */
?>

<grostitre>Introduction</grostitre>

<p>ScrollTrigger est un plugiciel&nbsp;<em>(plugin)</em>&nbsp;d√©velopp√© par&nbsp;<a href="https://gsap.com"
        target="_blank">GSAP</a>&nbsp;permettant de d√©clencher ou synchroniser une animation avec le d√©filement de
    la&nbsp;page.</p>

<h3>Exemples d'utilisation</h3>

<codepen id="abRzZvy" notab="true" height="500"></codepen>
Credit: GSAP
<dots></dots>

<codepen id="zYmxoJB" notab="true" height="500"></codepen>
Credits: Louis Hoebregts
<dots></dots>

<codepen id="XWxJNBd" notab="true" height="500"></codepen>
Credits: Michelle Barker
<dots></dots>

<grostitre>Installation</grostitre>



<p>Comme pour tout plugiciel&nbsp;<em>(plugin)</em>&nbsp;pour GSAP, afin d'avoir acc√®s √† ses fonctionnalit√©s, il est
    n√©cessaire d'avoir incorpor√© la librairie GSAP pr√©alablement et d'ajouter ensuite le plugiciel dans le&nbsp;projet.
</p>


<h3>Pour ce faire, il est&nbsp;possible d'utiliser une des 3 techniques ci-bas :</h3>
<ul>
    <li>
        De le <a href="https://gsap.com/docs/v3/Installation/?tab=cdn&module=esm&method=private+registry&tier=free&club=false&require=false&trial=true#grab-the-files" target="_blank">t√©l√©charger sur le site de
           GSAP (bouton Get GSAP)</a>, üì• l'inclure dans votre dossier de projet et ajouter √† la fois le fichier
        <em>gsap-public/minified/gsap.min.js</em> si ce n'√©tait pas d√©j√† fait. De plus, vous ajouterez le plugiciel
        scrollTrigger avec <em>gsap-public/minified/ScrollTrigger.min.js</em>.<br><small>Prioriser toujours les versions
            minifi√©es qui sont plus performantes lors du chargement de la page.</small>
    </li>
    <li>
        D'utiliser un&nbsp;<a href="https://gsap.com/docs/v3/Installation/?tab=cdn&module=esm&method=private+registry&tier=free&club=false&require=false&trial=true#install-helper"
            target="_blank">Content Delivery Network (CDN)</a> (onglet CDN), comme vous avez l'habitude de faire. Vous devez y cocher la bo√Æte √† cocher du plugiciel ScrollTrigger, et plus bas, aller copier les 2 balises <span class='inline-code'>script</span> g√©n√©r√©es (une pour le coeur de gsap et l'autre pour le plugiciel ScrollTrigger) et les coller dans votre/vos page(s) HTML qui contiendront des animations GSAP.
    </li>
    <li>De partir des&nbsp;<a href="https://codepen.io/GreenSock/full/23d3979528b262cb07da37f6a7c7dd76"
            target="_blank">gabarits de base CodePen</a>. Vous devez copier le lien de GSAP Core et celui SrollTrigger
        et, sur votre
        CodePen via <em>Settings/JS/Add External Scripts</em>, y coller successivement les liens.</li>
</ul>

<alert>Toujours porter attention √† l'ordre des liens vers les fichiers JavaScript dans votre HTML. D'abord la librarie
    "core" de GSAP, ensuite le ou les plugiciel(s) GSAP, finalement le fichier JavaScript personnalis√© de votre projet.
</alert>
<warning>Ne pas oublier, au niveau performance, il est pr√©f√©rable de lier les fichiers JavaScript √† la fin de la page
    HTML juste avant la fermeture de <incode>&lt;/body&gt;</incode>. <br>Pensez "Optimisation Web" ! üìà üéØ ‚ö°</warning>


<dots></dots>




<p>Une fois charg√©e, il est conseill√© d'indiquer √† GSAP que ScrollTrigger est disponible en inscrivant la ligne de
    code&nbsp;suivante:</p>

<highlight lang="JavaScript">gsap.registerPlugin(ScrollTrigger);</highlight>

<warning>ScrollTrigger n‚Äôest compatible qu‚Äôavec GSAP 3.3.X et&nbsp;plus.</warning>
<alert>Il existe une autre librairie utilisant le nom <em>"ScrollTrigger"</em>. Si une animation ne se d√©clenche pas
    au moment d√©termin√© par ScrollTrigger, il est possible que la mauvaise librairie ait √©t√©&nbsp;charg√©e.</alert>


<dots></dots>


<grostitre>Utilisation de base</grostitre>


<p>Il est possible d'utiliser ScrollTrigger de fa√ßon tr√®s minimaliste. Pour ce faire, il suffit d'ajouter la
    propri√©t√©&nbsp;<incode>scrollTrigger</incode>&nbsp;√† une animation et de lui attribuer comme valeur le s√©lecteur devant
    d√©clencher l'animation&nbsp;<em>(commun√©ment appel√© le&nbsp;"trigger")</em>.</p>
<p>Par exemple, si un carr√© bleu‚Äâüü¶ poss√®de une animation, mais que le carr√© n'est visible qu'apr√®s avoir fait d√©filer
    la page, il est possible que son animation se termine avant m√™me que l'utilisateur puisse la&nbsp;voir.</p>
<p>Heureusement, l'utilisation de ScrollTrigger permet de retarder le d√©clenchement de l'animation au moment o√π la
    partie sup√©rieure du carr√© devient&nbsp;visible.</p>

<codepen id="oNagLXq" tab="js,result" height="400"></codepen>

<dots></dots>


<grostitre>Utilisation d'un objet {}</grostitre>

<p>Il est possible de raffiner le comportement d'une animation ScrollTrigger. Pour ce faire, il faut utiliser un objet
    JavaScript pouvant contenir plusieurs propri√©t√©s et valeurs plut√¥t qu'une valeur texte comme dans
    l'exemple&nbsp;pr√©c√©dent.</p>
<p>Par exemple, convertissons la valeur textuelle de l'exemple en&nbsp;objet.</p>

<codepen id="MWPYbxw" tab="js,result" height="400"></codepen>

<p>On remarque que la propri√©t√© permettant de d√©clencher l'animation est maintenant sp√©cifi√©e et
    s'appelle&nbsp;<incode>trigger</incode>.</p>

<dots></dots>


<grostitre>Markers</grostitre>

<p>La propri√©t√©&nbsp;<incode>markers</incode>&nbsp;permet de simplifier le d√©bogage d'une animation en affichant les
    marqueurs utilis√©s pour contr√¥ler l'animation. Par d√©faut, la valeur de cette propri√©t√© est
    √†&nbsp;<incode>false</incode>.</p>
<p>Pour l'activer, il faut lui donner la valeur&nbsp;<incode>true</incode>, comme dans l'exemple&nbsp;suivant:</p>

<codepen id="XWxJNQj" tab="js,result" height="400"></codepen>

<p><incode>scroller-start</incode>&nbsp;et&nbsp;<incode>scroller-end</incode>&nbsp;sont des marqueurs positionn√©s en lien avec
    la fen√™tre, tandis que&nbsp;<incode>start</incode>&nbsp;et&nbsp;<incode>end</incode>&nbsp;sont des marqueurs positionn√©s en
    lien avec le&nbsp;<incode>trigger</incode>&nbsp;sp√©cifi√©.</p>
<p>On remarque que l'animation du carr√© bleu‚Äâüü¶ d√©bute uniquement lorsque le
    marqueur&nbsp;<incode>start</incode>&nbsp;croise le marqueur&nbsp;<incode>scroll-start</incode>.</p>



<dots></dots>
<grostitre>Start et End</grostitre>


<p>Les propri√©t√©s&nbsp;<incode>start</incode>&nbsp;et&nbsp;<incode>end</incode>&nbsp;de l'objet ScrollTrigger sont constitu√©es
    de deux valeurs. Une premi√®re correspondant au marqueur associ√© au&nbsp;<incode>trigger</incode>&nbsp;et une deuxi√®me au
    marqueur associ√© √† la fen√™tre.</p>
<p>Il est possible de modifier ces valeurs en passant une chaine de caract√®res constitu√©e soit de:</p>


<ul>
    <li>
        <p>Positions sous forme de texte:&nbsp;<incode>top</incode>,&nbsp;<incode>center</incode>,&nbsp;<incode>bottom</incode></p>
    </li>
    <li>
        <p>Pourcentage, ex:&nbsp;<incode>50%</incode></p>
    </li>
    <li>
        <p>Unit√© absolue, ex:&nbsp;<incode>200px</incode></p>
    </li>
    <li>
        <p>Unit√© relative, ex:&nbsp;&nbsp;<incode>+=200</incode></p>
    </li>
</ul>


<dots></dots>

<h3 id="Start">Start</h3>

<p>Par d√©faut la propri√©t√©&nbsp;<incode>start</incode>&nbsp;a la valeur&nbsp;<incode>"top bottom"</incode>, indiquant que:</p>
<ol>
    <li>top: le marqueur&nbsp;<incode>start</incode>&nbsp;est positionn√© au sommet (top) de l'<strong>√©l√©ment
            d√©clencheur (<incode>trigger</incode>)</strong></li>
    <li>bottom: le marqueur&nbsp;<incode>scroller-start</incode>&nbsp;est positionn√© au bas (bottom) de la&nbsp;<strong>fen√™tre du
            navigateur</strong></li>
</ol>
<p>Donc la premi√®re valeur de ce duo (exemple <incode>"top bottom"</incode>) correspont √† la postion du marqueur de l'√©l√©ment d√©clencheur
(<incode>trigger</incode>) et la deuxi√®me valeur correspont √† la position du marqueur de la fen√™tre du navigateur.</p>

    <dots></dots>
<p>Autre exemple: √† la place de d√©clencher l'animation quand elle entre dans la fen√™tre, on pourrait la d√©clencher
    lorsque le milieu de
    l'√©l√©ment d√©clencheur (<incode>trigger</incode>) atteint 75% de la page, en changeant la valeur de <incode>start</incode> pour <incode>"center 75%"</incode>. </p>

<ol>
    <li>center: le marqueur&nbsp;<incode>start</incode>&nbsp;est positionn√© au centre (center) de l'<strong>√©l√©ment
            d√©clencheur (<incode>trigger</incode>)</strong></li>
    <li>75%: le marqueur&nbsp;<incode>scroller-start</incode>&nbsp;est positionn√© √† 75% de la hauteur de la&nbsp;<strong>fen√™tre du
            navigateur</strong></li>
</ol>

<p> En voici l'exemple:</p>

<codepen id="BaqyQEM" tab="js,result" height="400"></codepen>
<doclink href="https://gsap.com/docs/v3/Plugins/ScrollTrigger/start/">start</doclink>

<dots></dots>
<h3 id="End">End</h3>

<p>Par d√©faut la propri√©t√©&nbsp;<incode>end</incode>&nbsp;a la valeur&nbsp;<incode>"bottom top"</incode>.</p>

<p>La propri√©t√©&nbsp;<incode>end</incode>&nbsp;se comporte exactement comme la propri√©t√©&nbsp;<a rel="noopener noreferrer"
        href="#start">start</a>&nbsp;√† la diff√©rence bien sur qu'elle contr√¥le les
    marqueurs&nbsp;<incode>end</incode>&nbsp;et&nbsp;<incode>scroller-end</incode>.</p>



<doclink href="https://gsap.com/docs/v3/Plugins/ScrollTrigger/end/">end</doclink>




<dots></dots>
<grostitre>ToggleActions</grostitre>


<p>La propri√©t√©&nbsp;<incode>toggleActions</incode>&nbsp;permet de sp√©cifier des actions qui seront d√©clench√©es lors de
    moments&nbsp;pr√©cis.</p>


<h3 class="heading heading--h3" id="Moments">Moments</h3>

<ol start="1">
    <li>
        <p><incode>onEnter</incode>: lorsque la page d√©file vers le haut‚Äâ‚¨ÜÔ∏è et que le
            marqueur&nbsp;<incode>start</incode>&nbsp;croise le marqueur&nbsp;<incode>scroller-start</incode></p>
    </li>
    <li>
        <p><incode>onLeave</incode>: lorsque la page d√©file vers le haut‚Äâ‚¨ÜÔ∏è et que le
            marqueur&nbsp;<incode>end</incode>&nbsp;croise le marqueur&nbsp;<incode>scroller-end</incode></p>
    </li>
    <li>
        <p><incode>onEnterBack</incode>: lorsque la page d√©file vers le bas‚Äâ‚¨áÔ∏è et que le
            marqueur&nbsp;<incode>end</incode>&nbsp;croise √† nouveau le marqueur&nbsp;<incode>scroller-end</incode></p>
    </li>
    <li>
        <p><incode>onLeaveBack</incode>: lorsque la page d√©file vers le bas‚Äâ‚¨áÔ∏è et que le
            marqueur&nbsp;<incode>start</incode>&nbsp;croise √† nouveau le marqueur&nbsp;<incode>scroller-start</incode></p>
    </li>
</ol>



<dots></dots>



<h3 id="Actions">Actions</h3>
<ul>
    <li>
        <incode>play</incode>: d√©clenche l'animation
    </li>
    <li>
        <incode>pause</incode>: met l'animation sur&nbsp;pause
    </li>
    <li>
        <incode>resume</incode>: continue l'animation en fonction de sa progression&nbsp;actuelle
    </li>
    <li>
        <incode>reset</incode>: ram√®ne l'animation √† son √©tat de&nbsp;d√©part
    </li>
    <li>
        <incode>restart</incode>: ram√®ne l'animation √† son √©tat de d√©part et la&nbsp;d√©clenche
    </li>
    <li>
        <incode>complete</incode>: am√®ne l'animation √† son √©tat de fin
    </li>
    <li>
        <incode>reverse</incode>: joue l'animation en sens inverse en √† partir de sa progression&nbsp;actuelle
    </li>
    <li>
        <incode>none</incode>: rien ne se&nbsp;produit
    </li>
</ul>



<dots></dots>
<h3>ToggleActions par d√©faut</h3>
<p>Par d√©faut, toggleAction √† une valeur de&nbsp;<incode>"play none none none"</incode>.</p>

<p>Autrement dit:</p>
<ol start="1">
    <li>
        <incode>onEnter</incode> l'animation est d√©clench√©e.
    </li>
    <li>
        <incode>onLeave</incode> rien ne se&nbsp;produit
    </li>
    <li>
        <incode>onEnterBack</incode>&nbsp;rien ne se&nbsp;produit
    </li>
    <li>
        <incode>onLeaveBack</incode>&nbsp;rien ne se&nbsp;produit
    </li>
</ol>


<dots></dots>
<h3>Modifier les valeurs par d√©faut de ToggleActions</h3>
<p>Il est possible de modifier ces&nbsp;comportements.</p>
<p>Par exemple, pour qu'une&nbsp;animation:</p>
<ul>
    <li>
        se d√©clenche √† chaque fois que le
        marqueur&nbsp;<incode>start</incode>&nbsp;croise&nbsp;<incode>scroller-start</incode>,
    </li>
    <li>
        se compl√®te lorsque le marqueur&nbsp;<incode>end</incode>&nbsp;croise&nbsp;<incode>scroller-end</incode>,
    </li>
    <li>
        joue √† l'envers lorsque le
        marqueur&nbsp;<incode>end</incode>&nbsp;croise&nbsp;<incode>scroller-end</incode>&nbsp;dans la
        direction&nbsp;oppos√©e,
    </li>
    <li>
        retourne √† son √©tat initial lorsque le
        marqueur&nbsp;<incode>start</incode>&nbsp;croise&nbsp;<incode>scroller-start</incode>&nbsp;dans la
        direction&nbsp;oppos√©e,
    </li>
</ul>



<p>il faudra changer la valeur de <incode>toggleActions</incode> pour<br><incode>"restart complete reverse reset"</incode></p>
<p>En voici l'exemple: </p>

<codepen id="rNqajBM" tab="js,result" height="600"></codepen>

<dots></dots>
<p>Pour bien visualiser et comprendre chaque moment et chaque action disponible, je vous sugg√®re de regarder cette d√©mo.
</p>


<tool href="../tools/demo-toggleaction/"></tool>



<dots></dots>
<grostitre>Avec une Timeline</grostitre>

<p>Il est possible de combiner ScrollTrigger √† une&nbsp;<a target="_blank" rel="noopener noreferrer"
        href="../timeline">timeline GSAP</a>. Pour ce faire il suffit de passer un objet ScrollTrigger comme
    propri√©t√© dans l'objet de configurations de la timeline en&nbsp;question.</p>


<p>Par exemple:</p>


<codepen id="WNabRbe" tab="js,result" height="400"></codepen>

<doclink href="https://gsap.com/docs/v3/Plugins/ScrollTrigger/">ScrollTrigger</doclink>

<dots></dots>
<exercice href="../exercices/scrolltrigger-historique-zelda"></exercice>
